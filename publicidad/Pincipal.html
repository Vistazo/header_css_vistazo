
         
<script async src="https://t.seedtag.com/t/6983-7463-01.js"></script>



         
<script type='text/javascript'>
    //Captura variables para DFP desde la url
    var getQueryString = function (field, url) {
        var href = url ? url : window.location.href;
        var reg = new RegExp('[?&]' + field + '=([^&#]*)', 'i');
        var string = reg.exec(href);
        return string ? string[1] : null;
    };
    dfp_demo = getQueryString("demo");
    var VI_Seccion = '${secPub}';
    var VI_Tipo = 'Portada';
    var VI_Subseccion = '';
    var VI_Articulo = '';
    var VI_Tag = '';
    // Detecta si la página está siendo cargada por un bot común o headless browser
    function isLikelyBot() {
        return /bot|crawl|slurp|spider/i.test(navigator.userAgent) || !('onscroll' in window) || /HeadlessChrome/.test(navigator.userAgent);
    }

    // Si no es un bot, carga el script de Teads Analytics
    if (!isLikelyBot()) {
        var script = document.createElement('script');
        script.src = 'https://a.teads.tv/analytics/tag.js';
        script.async = true;
        document.head.appendChild(script);
    }
     //Teads Analytics -->
    document.addEventListener("DOMContentLoaded", function() {
        var teadsAnalyticsLoaded = false;
        function loadTeadsAnalytics() {
            if (!teadsAnalyticsLoaded) {
                teadsAnalyticsLoaded = true;
                window.teads_analytics = window.teads_analytics || {};
                window.teads_analytics.analytics_tag_id = "PUB_18943";
                window.teads_analytics.share = window.teads_analytics.share || function () {
                    (window.teads_analytics.shared_data = window.teads_analytics.shared_data || []).push(arguments);
                };
            }
        }
        setTimeout(loadTeadsAnalytics, 3000);
        function handleFirstInteraction() {
            loadTeadsAnalytics();
            document.removeEventListener('click', handleFirstInteraction);
            document.removeEventListener('scroll', handleFirstInteraction);
        }
        document.addEventListener('click', handleFirstInteraction);
        document.addEventListener('scroll', handleFirstInteraction, { passive: true });
    });
    
</script>


<!-- Google Tag Manager -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        var gtmLoaded = false;
        function loadGTM() {
            if (!gtmLoaded) {
                gtmLoaded = true;
                (function(w, d, s, l, i) {
                    w[l] = w[l] || [];
                    w[l].push({
                        'gtm.start': new Date().getTime(),
                        event: 'gtm.js'
                    });
                    var f = d.getElementsByTagName(s)[0],
                        j = d.createElement(s),
                        dl = l !== 'dataLayer' ? '&l=' + l : '';
                    j.async = true;
                    j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
                    f.parentNode.insertBefore(j, f);
                })(window, document, 'script', 'dataLayer', 'GTM-MJB87NX');
            }
        }
        function isLikelyBot() {
            return /bot|crawl|slurp|spider/i.test(navigator.userAgent) || !('onscroll' in window) || /HeadlessChrome/.test(navigator.userAgent);
        }

        // Verifica si el validador en localStorage ha expirado
        function shouldLoadImmediately() {
            var lastLoadTime = localStorage.getItem('lastLoadTime');
            if (lastLoadTime) {
                var elapsed = Date.now() - parseInt(lastLoadTime);
                return elapsed > 28800000; // 8 horas en milisegundos
            }
            return true;
        }

        if (!isLikelyBot()) {
            if (shouldLoadImmediately()) {
                loadGTM();
                localStorage.setItem('lastLoadTime', Date.now().toString());
            } else {
                setTimeout(loadGTM, 5000);
            }
        }
        function handleFirstInteraction() {
            loadGTM();
            document.removeEventListener('click', handleFirstInteraction);
            document.removeEventListener('scroll', handleFirstInteraction);
        }
        document.addEventListener('click', handleFirstInteraction);
        document.addEventListener('scroll', handleFirstInteraction, { passive: true });
    });
</script>

<!-- Google Publisher Tag (GPT) -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        var gptLoaded = false;
        function loadGPT() {
            if (!gptLoaded) {
                gptLoaded = true;
                var gptScript = document.createElement('script');
                gptScript.async = true;
                gptScript.src = 'https://securepubads.g.doubleclick.net/tag/js/gpt.js';
                document.head.appendChild(gptScript);
                // Esperar a que el script se cargue antes de ejecutar cualquier código de GPT
                gptScript.onload = function() {
                    window.googletag = window.googletag || {cmd: []};
                    googletag.cmd.push(function() {
                        console.log("Google Publisher Tag cargado correctamente.");
                        // Aquí va toda la configuración de anuncios y slots
                    });
                };
            }
        }
        function isLikelyBot() {
            return /bot|crawl|slurp|spider/i.test(navigator.userAgent) || !('onscroll' in window) || /HeadlessChrome/.test(navigator.userAgent);
        }

        // Verifica si el validador en localStorage ha expirado
        function shouldLoadImmediately() {
            var lastLoadTime = localStorage.getItem('lastLoadTime');
            if (lastLoadTime) {
                var elapsed = Date.now() - parseInt(lastLoadTime);
                return elapsed > 28800000; // 8 horas en milisegundos
            }
            return true;
        }

        if(!isLikelyBot()) {
            // Temporizador para cargar GPT después de 5 segundos si no hay interacción antes
            if (shouldLoadImmediately()) {
                loadGPT();
                localStorage.setItem('lastLoadTime', Date.now().toString());
            } else {
                setTimeout(loadGPT, 5000);
            }
        }
        // Evento para cargar GPT en la primera interacción
        function handleFirstInteraction() {
            loadGPT();
            document.removeEventListener('click', handleFirstInteraction);
            document.removeEventListener('scroll', handleFirstInteraction);
        }
        document.addEventListener('click', handleFirstInteraction);
        document.addEventListener('scroll', handleFirstInteraction, { passive: true });
    });
</script>


<script>
    document.addEventListener("DOMContentLoaded", function() {
        var gptScriptLoaded = false;
        function loadGPTScript() {
            if (!gptScriptLoaded) {
                gptScriptLoaded = true;
                // Todo el código GPT que necesitas ejecutar
                const metaTags = document.getElementsByTagName('meta');
                let noAdsMetaTagFound = false;
    
                for (let i = 0; i < metaTags.length; i++) {
                    if (metaTags[i].getAttribute('name') === 'keywords' && metaTags[i].getAttribute('content') === 'no-ads') {
                        noAdsMetaTagFound = true;
                        break;
                    }
                }
    
                if (!noAdsMetaTagFound) {
                    initializeAdSlots();
                    displayAds();
                    //setTimeout(displayAds, 2000)
                    // fin - Bottom_Anchor
                    console.log('Ads will be loaded because no "no-ads" meta tag was found.');
                } else {
                    console.log('No ads to load, "no-ads" meta tag found.');
                }
            }
        }
    
        function initializeAdSlots() {
            // Aquí iría el resto del código para configurar y activar los anuncios
            window.googletag = window.googletag || { cmd: [] };
            googletag.cmd.push(function () {
                //required variable for refresh
                var REFRESH_KEY = "refresh";
                var REFRESH_VALUE = "true";
                var mappingbill = googletag.sizeMapping()
                    .addSize([992, 0], [[970, 250], [970, 180], [970, 90], [728, 250], [728, 180], [728, 90]]).addSize([768, 0], [[728, 250], [728, 180], [728, 90]]).addSize([320, 0], [[320, 100], [320, 50], [300, 100], [300, 50]]).addSize([0, 0], [[300, 100], [300, 250], [320, 100]]).build();
                var mappingbox = googletag.sizeMapping()
                    .addSize([992, 0], [[300, 600], [300, 250]]).addSize([768, 0], [[300, 600], [300, 250]]).addSize([320, 0], [[300, 250], [320, 100], [320, 50], [300, 100], [300, 50]]).addSize([0, 0], [[300, 250], [300, 100], [300, 50]]).build();
                var mappingcenter = googletag.sizeMapping()
                    .addSize([992, 0], [[728, 90], [728, 180], [728, 250]]).addSize([768, 0], [[728, 90], [728, 180], [728, 250]]).addSize([320, 0], [[320, 100], [300, 100], [300, 250]]).addSize([0, 0], [[320, 100], [300, 100], [300, 250]]).build();
                var mappingHeader = googletag.sizeMapping()
                    .addSize([992, 0], [[728, 90], [970, 90]]).addSize([768, 0], [[728, 90]]).addSize([320, 0], [[320, 50]]).addSize([0, 0], [[320, 50]]).build();
    
                //adUnits
                googletag.defineSlot('/21839199781/Vistazo/Vistazo_Top1', [[300, 100], [300, 250], [320, 100], [728, 90], [970, 90], [970, 250]], 'Top1').defineSizeMapping(mappingbill).setTargeting(REFRESH_KEY, REFRESH_VALUE).addService(googletag.pubads());
                googletag.defineSlot('/21839199781/Vistazo/Vistazo_Leader1', [[320, 100], [300, 100], [300, 250], [336, 280], [728, 90]], 'Leader1').defineSizeMapping(mappingcenter).setTargeting(REFRESH_KEY, REFRESH_VALUE).addService(googletag.pubads());
                googletag.defineSlot('/21839199781/Vistazo/Vistazo_Center1', [[320, 100], [300, 100], [300, 250], [728, 90]], 'Center1').defineSizeMapping(mappingcenter).setTargeting(REFRESH_KEY, REFRESH_VALUE).addService(googletag.pubads());
                googletag.defineSlot('/21839199781/Vistazo/Vistazo_Center2', [[320, 100], [300, 100], [300, 250], [728, 90]], 'Center2').defineSizeMapping(mappingcenter).setTargeting(REFRESH_KEY, REFRESH_VALUE).addService(googletag.pubads());
                googletag.defineSlot('/21839199781/Vistazo/Vistazo_Center3', [[320, 100], [300, 100], [300, 250], [728, 90]], 'Center3').defineSizeMapping(mappingcenter).setTargeting(REFRESH_KEY, REFRESH_VALUE).addService(googletag.pubads());
                //Reemplaza al Box de la home -------
                googletag.defineSlot('/21839199781/Vistazo/Vistazo_Middle1', [[300, 600], [300, 250]], 'Middle1').defineSizeMapping(mappingbox).setTargeting(REFRESH_KEY, REFRESH_VALUE).addService(googletag.pubads());
                //-----------------------------------
                googletag.defineSlot('/21839199781/Vistazo/Vistazo_Middle2', [300, 250], 'Middle2').defineSizeMapping(mappingbox).setTargeting(REFRESH_KEY, REFRESH_VALUE).addService(googletag.pubads());
                googletag.defineSlot('/21839199781/Vistazo/Floating', [1, 1], 'Floating').addService(googletag.pubads());
                googletag.defineSlot('/21839199781/Vistazo/Zocalo', [1, 3], 'Zocalo').addService(googletag.pubads());
                //Agregar este tag a la pagina
                googletag.defineSlot('/21839199781/Vistazo/header', [[320, 50], [970, 90], [728, 90], [300, 50]], 'header_ad').defineSizeMapping(mappingHeader).addService(googletag.pubads());
                googletag.pubads().enableLazyLoad({
                    fetchMarginPercent: 20,
                    renderMarginPercent: 10,
                    mobileScaling: 2.0,
                });
                //Start refresh
                var SECONDS_TO_WAIT_AFTER_VIEWABILITY = 30; // 30 seconds
                googletag.pubads().addEventListener("impressionViewable", function (event) {
                    var slot = event.slot;
                    if (slot.getTargeting(REFRESH_KEY).indexOf(REFRESH_VALUE) > -1) {
                        setTimeout(function () {
                            googletag.pubads().refresh([slot]);
                        }, SECONDS_TO_WAIT_AFTER_VIEWABILITY * 1000);
                    }
                });
                //End refresh
                if (jQryIter.contextIsArticlePage()) {
                    VI_Tipo = 'Artículo';
                    VI_Subseccion = '${SectionName}';
                    var urltemp = window.location.href;
                    var n = urltemp.lastIndexOf("-");
                    VI_Articulo = urltemp.substring(n + 3);
                }
                // metadatos
                $("meta[data-voc-name=topic]").each(function () {
                    if (VI_Tag == '') {
                        VI_Tag = $(this).attr('content');
                    }
                    else {
                        VI_Tag = VI_Tag + "," + $(this).attr('content');
                    }
                });
    
                parts = (window.location.href.split("/"));
                console.log("parts", parts[3]);
    
                if (parts[3] == 'hogar' && parts.length <= 4) {
                    VI_Seccion = 'Home-hogar';
                }
                if (parts[3].includes('taller-cocina-colada-morada-guaguas-pan')) {
    
                    VI_Seccion = 'formulariod4';
                }
    
                if (parts[4] && parts[4] != "") {
                    VI_Seccion = 'Home-hogar';
                    VI_Subseccion = parts[4] + '-hogar';
                }
                //console.log('VI_Seccion:' + VI_Seccion);
                //console.log('VI_Subec:' + VI_Subseccion);
                //console.log('VI_Tipo:' + VI_Tipo);
                //console.log('VI_Articulo:' + VI_Articulo);
                //console.log('VI_Tag:' + VI_Tag);
                //console.log('dfp_demo:' + dfp_demo);
                googletag.pubads().setTargeting('VI_Seccion', VI_Seccion);
                googletag.pubads().setTargeting('VI_Subseccion', VI_Subseccion);
                googletag.pubads().setTargeting('VI_Tipo', VI_Tipo);
                googletag.pubads().setTargeting('VI_Articulo', VI_Articulo);
                googletag.pubads().setTargeting('VI_Tag', VI_Tag);
                //googletag.pubads().setTargeting('VI_Demo', dfp_demo);
                googletag.pubads().setTargeting('censurado', 'no');
                googletag.pubads().enableSingleRequest();
                googletag.pubads().collapseEmptyDivs();
                googletag.enableServices();
            });
          
            // inicio - Bottom_Anchor
            var interstitialSlot, bottomAnchorSlot;
            googletag.cmd.push(function () {
                interstitialSlot = googletag.defineOutOfPageSlot("/21839199781/Vistazo_Web-ITT",googletag.enums.OutOfPageFormat.INTERSTITIAL);
                interstitialSlot && interstitialSlot.addService(googletag.pubads());
                //bottomAnchorSlot = googletag.defineOutOfPageSlot("/21839199781/Vistazo_Bottom_Anchor",googletag.enums.OutOfPageFormat.BOTTOM_ANCHOR);
                //bottomAnchorSlot && bottomAnchorSlot.addService(googletag.pubads());
            });
            // fin - Bottom_Anchor
            googletag.cmd.push(function () {
                interstitialSlot && googletag.display(interstitialSlot);
                bottomAnchorSlot && googletag.display(bottomAnchorSlot);
            });

        }

        function displayAds() {
            // Verificamos que googletag y sus comandos estén definidos
            if (window.googletag && window.googletag.cmd) {
                // Aseguramos que los comandos se ejecuten después de que GPT esté completamente cargado
                googletag.cmd.push(function() {
                    // Ahora verificamos cada slot individualmente antes de intentar mostrarlo
                    if (document.getElementById('Top1') && googletag.pubads().getSlots().some(slot => slot.getSlotElementId() === 'Top1')) {
                        googletag.display('Top1');
                    }
                    if (document.getElementById('Leader1') && googletag.pubads().getSlots().some(slot => slot.getSlotElementId() === 'Leader1')) {
                        googletag.display('Leader1');
                    }
                    if (document.getElementById('Center1') && googletag.pubads().getSlots().some(slot => slot.getSlotElementId() === 'Center1')) {
                        googletag.display('Center1');
                    }
                    if (document.getElementById('Center2') && googletag.pubads().getSlots().some(slot => slot.getSlotElementId() === 'Center2')) {
                        googletag.display('Center2');
                    }
                    if (document.getElementById('Center3') && googletag.pubads().getSlots().some(slot => slot.getSlotElementId() === 'Center3')) {
                        googletag.display('Center3');
                    }
                    if (document.getElementById('Middle2') && googletag.pubads().getSlots().some(slot => slot.getSlotElementId() === 'Middle2')) {
                        googletag.display('Middle2');
                    }
                    if (document.getElementById('Middle1') && googletag.pubads().getSlots().some(slot => slot.getSlotElementId() === 'Middle1')) {
                        googletag.display('Middle1');
                    }
                    if (document.getElementById('header_ad') && googletag.pubads().getSlots().some(slot => slot.getSlotElementId() === 'header_ad')) {
                        googletag.display('header_ad');
                    }
                    if (document.getElementById('Floating') && googletag.pubads().getSlots().some(slot => slot.getSlotElementId() === 'Floating')) {
                        googletag.display('Floating');
                    }
                    if (document.getElementById('Zocalo') && googletag.pubads().getSlots().some(slot => slot.getSlotElementId() === 'Zocalo')) {
                        googletag.display('Zocalo');
                    }
                });
            } else {
                console.log("Google Tag Library not loaded");
                setTimeout(displayAds, 2000);
            }
        }
        
        
        function isLikelyBot() {
            return /bot|crawl|slurp|spider/i.test(navigator.userAgent) || !('onscroll' in window) || /HeadlessChrome/.test(navigator.userAgent);
        }

        // Verifica si el validador en localStorage ha expirado
        function shouldLoadImmediately() {
            var lastLoadTime = localStorage.getItem('lastLoadTime');
            if (lastLoadTime) {
                var elapsed = Date.now() - parseInt(lastLoadTime);
                return elapsed > 28800000; // 8 horas en milisegundos
            }
            return true;
        }        

        if(!isLikelyBot()) {
            // Temporizador para cargar el script después de 5 segundos si no hay interacción antes
            if (shouldLoadImmediately()) {
                loadGPTScript();
                localStorage.setItem('lastLoadTime', Date.now().toString());
            } else {
                setTimeout(loadGPTScript, 5000);
            }
        }
    
        // Evento para cargar el script en la primera interacción
        function handleFirstInteraction() {
            loadGPTScript();
            document.removeEventListener('click', handleFirstInteraction);
            document.removeEventListener('scroll', handleFirstInteraction);
        }
    
        // Añadir manejadores de eventos para las primeras interacciones del usuario
        document.addEventListener('click', handleFirstInteraction);
        document.addEventListener('scroll', handleFirstInteraction, { passive: true });
    });
</script>
      
      
      